╔══════════════════════════════════════════════════════════════╗
║         🚨 ERREUR 500 - RÉCURSION INFINIE RLS               ║
╚══════════════════════════════════════════════════════════════╝

PROBLÈME : Erreur "infinite recursion detected in policy"
CAUSE    : Les politiques RLS créent une boucle infinie
IMPACT   : L'application est complètement inutilisable

┌──────────────────────────────────────────────────────────────┐
│  SOLUTION RAPIDE (2 minutes)                                 │
└──────────────────────────────────────────────────────────────┘

1. Ouvrir Supabase Dashboard
   → https://app.supabase.com
   
2. Aller dans "SQL Editor"

3. Copier TOUT le contenu du fichier :
   📄 fix_infinite_recursion_rls.sql

4. Coller dans l'éditeur SQL

5. Cliquer sur "Run" (bouton vert en bas à droite)

6. Attendre le message "✅ RÉCURSION RLS CORRIGÉE"

7. FERMER tous les onglets de l'app et rouvrir

┌──────────────────────────────────────────────────────────────┐
│  VÉRIFICATION                                                │
└──────────────────────────────────────────────────────────────┘

Dans le SQL Editor, exécuter :

    SELECT * FROM check_sync_quick();

Vous devriez voir que "manquants" = 0

┌──────────────────────────────────────────────────────────────┐
│  FICHIERS IMPORTANTS                                         │
└──────────────────────────────────────────────────────────────┘

✅ fix_infinite_recursion_rls.sql
   → Script à appliquer MAINTENANT pour corriger la récursion

📖 CORRECTION_RECURSION_IMMEDIATE.md
   → Guide complet avec dépannage

🔧 fix_user_sync_safe.sql
   → À appliquer APRÈS la correction de récursion

📚 GUIDE_CORRECTION_SYNCHRONISATION_COMPLETE.md
   → Documentation complète

┌──────────────────────────────────────────────────────────────┐
│  ORDRE D'APPLICATION                                         │
└──────────────────────────────────────────────────────────────┘

1️⃣ MAINTENANT : fix_infinite_recursion_rls.sql
                (corrige la récursion RLS)

2️⃣ ENSUITE    : fix_user_sync_safe.sql
                (synchronisation automatique)

┌──────────────────────────────────────────────────────────────┐
│  SI ÇA NE FONCTIONNE PAS                                     │
└──────────────────────────────────────────────────────────────┘

Lire le fichier : CORRECTION_RECURSION_IMMEDIATE.md
Section "Si le problème persiste"

═══════════════════════════════════════════════════════════════

    Temps estimé : 2 minutes
    Impact : Débloque toute l'application immédiatement
    Priorité : CRITIQUE 🔴

═══════════════════════════════════════════════════════════════

